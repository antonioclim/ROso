<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 500" width="850" height="500">
  <defs>
    <style>
      .process { fill: #e8f5e9; stroke: #388e3c; stroke-width: 2; rx: 10; }
      .signal { fill: #ffecb3; stroke: #ff8f00; stroke-width: 2; rx: 5; }
      .signal-kill { fill: #ffcdd2; stroke: #c62828; stroke-width: 2; rx: 5; }
      .trap { fill: #e1f5fe; stroke: #0277bd; stroke-width: 2; rx: 5; }
      .action { fill: #f3e5f5; stroke: #7b1fa2; stroke-width: 2; rx: 5; }
      .arrow { fill: none; stroke: #424242; stroke-width: 2; marker-end: url(#arrowhead); }
      .arrow-signal { fill: none; stroke: #ff8f00; stroke-width: 2.5; stroke-dasharray: 5,3; marker-end: url(#arroworange); }
      .text { font-family: 'Segoe UI', Arial, sans-serif; font-size: 12px; fill: #212121; }
      .text-title { font-family: 'Segoe UI', Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #1565c0; }
      .text-code { font-family: 'Courier New', monospace; font-size: 11px; fill: #424242; }
      .text-signal { font-family: 'Courier New', monospace; font-size: 10px; font-weight: bold; fill: #e65100; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#424242"/>
    </marker>
    <marker id="arroworange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ff8f00"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="425" y="25" text-anchor="middle" class="text-title">Signal Flow și Trap Handling</text>
  
  <!-- Sources -->
  <text x="50" y="60" class="text-title">Surse de Semnale</text>
  
  <rect x="50" y="80" width="120" height="40" class="signal"/>
  <text x="110" y="100" text-anchor="middle" class="text">Ctrl+C</text>
  <text x="110" y="115" text-anchor="middle" class="text-signal">SIGINT (2)</text>
  
  <rect x="50" y="140" width="120" height="40" class="signal"/>
  <text x="110" y="160" text-anchor="middle" class="text">Terminal Close</text>
  <text x="110" y="175" text-anchor="middle" class="text-signal">SIGHUP (1)</text>
  
  <rect x="50" y="200" width="120" height="40" class="signal"/>
  <text x="110" y="220" text-anchor="middle" class="text">kill PID</text>
  <text x="110" y="235" text-anchor="middle" class="text-signal">SIGTERM (15)</text>
  
  <rect x="50" y="260" width="120" height="40" class="signal-kill"/>
  <text x="110" y="280" text-anchor="middle" class="text">kill -9 PID</text>
  <text x="110" y="295" text-anchor="middle" class="text-signal">SIGKILL (9)</text>
  
  <rect x="50" y="320" width="120" height="40" class="signal"/>
  <text x="110" y="340" text-anchor="middle" class="text">Custom</text>
  <text x="110" y="355" text-anchor="middle" class="text-signal">SIGUSR1 (10)</text>
  
  <!-- Process -->
  <rect x="350" y="130" width="150" height="180" class="process"/>
  <text x="425" y="160" text-anchor="middle" class="text" style="font-weight:bold">PROCES</text>
  <text x="425" y="180" text-anchor="middle" class="text-code">PID: $$</text>
  
  <!-- Trap handlers inside process -->
  <rect x="365" y="200" width="120" height="30" class="trap"/>
  <text x="425" y="220" text-anchor="middle" class="text-code">trap handler</text>
  
  <rect x="365" y="240" width="120" height="30" class="trap"/>
  <text x="425" y="260" text-anchor="middle" class="text-code">cleanup()</text>
  
  <!-- Signal arrows -->
  <line x1="170" y1="100" x2="350" y2="180" class="arrow-signal"/>
  <line x1="170" y1="160" x2="350" y2="190" class="arrow-signal"/>
  <line x1="170" y1="220" x2="350" y2="200" class="arrow-signal"/>
  <line x1="170" y1="280" x2="350" y2="220" class="arrow-signal" style="stroke:#c62828"/>
  <line x1="170" y1="340" x2="350" y2="230" class="arrow-signal"/>
  
  <!-- Actions -->
  <text x="600" y="60" class="text-title">Acțiuni</text>
  
  <rect x="600" y="100" width="180" height="35" class="action"/>
  <text x="690" y="122" text-anchor="middle" class="text">Execută cleanup()</text>
  
  <rect x="600" y="150" width="180" height="35" class="action"/>
  <text x="690" y="172" text-anchor="middle" class="text">Salvează stare</text>
  
  <rect x="600" y="200" width="180" height="35" class="action"/>
  <text x="690" y="222" text-anchor="middle" class="text">Log eveniment</text>
  
  <rect x="600" y="250" width="180" height="35" class="action"/>
  <text x="690" y="272" text-anchor="middle" class="text">Terminare grațioasă</text>
  
  <rect x="600" y="300" width="180" height="35" class="action" style="fill:#ffcdd2"/>
  <text x="690" y="322" text-anchor="middle" class="text">Terminare FORȚATĂ</text>
  <text x="690" y="332" text-anchor="middle" class="text-code" style="font-size:9px">(SIGKILL - nu poate fi prins!)</text>
  
  <!-- Arrows from process to actions -->
  <line x1="500" y1="215" x2="600" y2="117" class="arrow"/>
  <line x1="500" y1="225" x2="600" y2="167" class="arrow"/>
  <line x1="500" y1="235" x2="600" y2="217" class="arrow"/>
  <line x1="500" y1="255" x2="600" y2="267" class="arrow"/>
  
  <!-- Code example -->
  <rect x="50" y="390" width="750" height="80" fill="#f5f5f5" stroke="#bdbdbd" rx="5"/>
  <text x="60" y="410" class="text-code">#!/bin/bash</text>
  <text x="60" y="425" class="text-code">cleanup() { rm -f "$TEMP_FILE"; echo "Cleaned up"; }</text>
  <text x="60" y="440" class="text-code">trap cleanup EXIT INT TERM    # Prinde EXIT, SIGINT, SIGTERM</text>
  <text x="60" y="455" class="text-code">trap '' HUP                   # Ignoră SIGHUP</text>
  <text x="60" y="470" class="text-code"># SIGKILL (kill -9) NU poate fi prins!</text>
  
  <!-- Legend -->
  <rect x="550" y="390" width="15" height="15" class="signal"/>
  <text x="575" y="402" class="text">Semnal normal</text>
  
  <rect x="550" y="415" width="15" height="15" class="signal-kill"/>
  <text x="575" y="427" class="text">Semnal fatal</text>
  
  <rect x="680" y="390" width="15" height="15" class="trap"/>
  <text x="705" y="402" class="text">Trap handler</text>
  
  <rect x="680" y="415" width="15" height="15" class="action"/>
  <text x="705" y="427" class="text">Acțiune</text>
  
  <!-- Footer -->
  <text x="425" y="495" text-anchor="middle" class="text" style="fill:#757575">SEM06 CAPSTONE - Sisteme de Operare | ASE București</text>
</svg>
