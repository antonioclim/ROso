#!/bin/bash
# =============================================================================
# BACKUP SYSTEM - Configuration File
# =============================================================================
# Sistem Enterprise de Backup - Fișier de Configurare
# Acest fișier definește toate opțiunile pentru sistemul de backup
# =============================================================================

# -----------------------------------------------------------------------------
# SURSE BACKUP
# -----------------------------------------------------------------------------
# Directoare/fișiere de inclus în backup (array, separate prin spații)
# Exemplu: BACKUP_SOURCES=("/home" "/etc" "/var/www")
BACKUP_SOURCES=("/home" "/etc")

# Directoare/fișiere de exclus (array cu patterns glob)
# Exemplu: EXCLUDE_PATTERNS=("*.tmp" "*.log" "cache/*" ".git")
EXCLUDE_PATTERNS=("*.tmp" "*.cache" "*.log" ".git" "__pycache__" "node_modules")

# -----------------------------------------------------------------------------
# DESTINAȚIE BACKUP
# -----------------------------------------------------------------------------
# Directorul unde se salvează backup-urile
BACKUP_DEST="/var/backups/system"

# Prefix pentru numele fișierelor backup
BACKUP_PREFIX="backup"

# Format pentru timestamp în numele fișierului
# Folosește format strftime: %Y=an, %m=lună, %d=zi, %H=oră, %M=minut
TIMESTAMP_FORMAT="%Y%m%d_%H%M%S"

# -----------------------------------------------------------------------------
# COMPRESIE
# -----------------------------------------------------------------------------
# Tipul de compresie: none, gzip, bzip2, xz, zstd
# gzip  = rapid, compresie moderată
# bzip2 = mai lent, compresie bună
# xz    = foarte lent, compresie excelentă
# zstd  = rapid, compresie bună (recomandat)
COMPRESSION="gzip"

# Nivel compresie (1-9, unde 9 = maxim)
COMPRESSION_LEVEL=6

# -----------------------------------------------------------------------------
# POLITICĂ DE RETENȚIE
# -----------------------------------------------------------------------------
# Backup-uri zilnice de păstrat
RETENTION_DAILY=7

# Backup-uri săptămânale de păstrat (create duminica)
RETENTION_WEEKLY=4

# Backup-uri lunare de păstrat (create pe 1 a lunii)
RETENTION_MONTHLY=12

# Ziua pentru backup săptămânal (0=duminică, 1=luni, ..., 6=sâmbătă)
WEEKLY_DAY=0

# Ziua din lună pentru backup lunar
MONTHLY_DAY=1

# -----------------------------------------------------------------------------
# VERIFICARE INTEGRITATE
# -----------------------------------------------------------------------------
# Verifică backup-ul după creare
VERIFY_BACKUP=true

# Salvează checksum pentru verificare ulterioară
SAVE_CHECKSUM=true

# Algoritmul de checksum: md5, sha1, sha256
CHECKSUM_ALGORITHM="sha256"

# Verifică integritatea arhivei (tar -tf)
VERIFY_ARCHIVE_LISTING=true

# -----------------------------------------------------------------------------
# PRE/POST PROCESARE
# -----------------------------------------------------------------------------
# Script de executat înainte de backup (poate opri backup-ul dacă returnează non-zero)
PRE_BACKUP_SCRIPT=""

# Script de executat după backup (primește calea arhivei ca argument)
POST_BACKUP_SCRIPT=""

# Timeout pentru scripturi pre/post (secunde)
SCRIPT_TIMEOUT=300

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
# Nivel de logging: DEBUG, INFO, WARN, ERROR
LOG_LEVEL="INFO"

# Fișier log principal
LOG_FILE="/var/log/backup/backup.log"

# Director pentru loguri individuale per backup
LOG_DIR="/var/log/backup"

# Retenție loguri (zile)
LOG_RETENTION_DAYS=30

# Activează output colorat
USE_COLORS=true

# -----------------------------------------------------------------------------
# NOTIFICĂRI
# -----------------------------------------------------------------------------
# Activează notificări email
NOTIFY_EMAIL=false

# Adrese email pentru notificări (separate prin virgulă)
EMAIL_RECIPIENTS="admin@example.com"

# Trimite email doar la erori
NOTIFY_ON_ERROR_ONLY=true

# Trimite email și la succes
NOTIFY_ON_SUCCESS=false

# Subiect email pentru succes
EMAIL_SUBJECT_SUCCESS="[BACKUP] Succes: $(hostname)"

# Subiect email pentru eroare
EMAIL_SUBJECT_ERROR="[BACKUP] EROARE: $(hostname)"

# -----------------------------------------------------------------------------
# OPȚIUNI AVANSATE
# -----------------------------------------------------------------------------
# Rulează în modul dry-run (simulare fără modificări)
DRY_RUN=false

# Verbose output (afișează fiecare fișier procesat)
VERBOSE=false

# Păstrează permisiuni și ownership
PRESERVE_PERMISSIONS=true

# Urmărește symlink-uri (backup conținutul, nu link-ul)
FOLLOW_SYMLINKS=false

# Exclude fișiere mai mari de (bytes, 0=dezactivat)
MAX_FILE_SIZE=0

# Nice level pentru proces (0-19, mai mare = prioritate mai mică)
NICE_LEVEL=10

# Ionice class (1=realtime, 2=best-effort, 3=idle)
IONICE_CLASS=3

# Timeout pentru operația de backup (secunde, 0=fără timeout)
BACKUP_TIMEOUT=0

# Fișier lock pentru a preveni execuții concurente
LOCK_FILE="/var/run/backup.lock"

# Timeout pentru achiziționarea lock-ului (secunde)
LOCK_TIMEOUT=60

# =============================================================================
# SFÂRŞIT CONFIGURARE
# =============================================================================
