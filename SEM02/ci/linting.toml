# ═══════════════════════════════════════════════════════════════════════════════
# Configurare Linting - Seminarul 02 SO
# ═══════════════════════════════════════════════════════════════════════════════
#
# Configurare pentru:
#   - shellcheck (Bash linting)
#   - ruff (Python linting - rapid, modern)
#   - flake8 (Python linting - clasic)
#
# UTILIZARE:
#   shellcheck --rcfile=ci/linting.toml scripts/bash/*.sh
#   ruff check --config=ci/linting.toml scripts/python/
#
# ═══════════════════════════════════════════════════════════════════════════════

# ═══════════════════════════════════════════════════════════════════════════════
# RUFF - Python Linter Modern
# ═══════════════════════════════════════════════════════════════════════════════
# Documentație: https://docs.astral.sh/ruff/

[tool.ruff]
# Versiune Python țintă
target-version = "py39"

# Lungime maximă linie
line-length = 100

# Directoare de exclus
exclude = [
    ".git",
    "__pycache__",
    ".venv",
    "venv",
    "*.egg-info",
    ".tox",
    ".mypy_cache",
    ".pytest_cache",
]

[tool.ruff.lint]
# Reguli de activat
select = [
    "E",      # pycodestyle errors
    "W",      # pycodestyle warnings
    "F",      # pyflakes
    "I",      # isort
    "B",      # flake8-bugbear
    "C4",     # flake8-comprehensions
    "UP",     # pyupgrade
    "SIM",    # flake8-simplify
]

# Reguli de ignorat
ignore = [
    "E501",   # line too long (gestionat separat)
    "E402",   # module level import not at top (util pentru scripturi)
    "B008",   # function-call-in-default-argument
    "B905",   # zip without strict (Python 3.10+)
    "SIM108", # use ternary operator (poate reduce lizibilitatea)
]

# Reguli per fișier
[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["F401"]  # imported but unused (normal pentru __init__)
"*_test.py" = ["S101"]    # assert în teste e OK

[tool.ruff.lint.isort]
# Configurare sortare importuri
known-first-party = ["scripts"]
force-single-line = false
lines-after-imports = 2

# ═══════════════════════════════════════════════════════════════════════════════
# FLAKE8 - Python Linter Clasic (alternativă la ruff)
# ═══════════════════════════════════════════════════════════════════════════════
# Notă: flake8 nu citește din pyproject.toml/TOML nativ
# Creează .flake8 în directorul rădăcină cu aceste setări:
#
# [flake8]
# max-line-length = 100
# extend-ignore = E501, E402
# exclude = .git, __pycache__, .venv, venv
# per-file-ignores =
#     __init__.py: F401

[tool.flake8_reference]
# Această secțiune e doar pentru referință
# Copiază în .flake8 pentru a folosi cu flake8
max_line_length = 100
extend_ignore = ["E501", "E402"]
exclude = [".git", "__pycache__", ".venv", "venv"]

# ═══════════════════════════════════════════════════════════════════════════════
# SHELLCHECK - Bash Linter
# ═══════════════════════════════════════════════════════════════════════════════
# Documentație: https://www.shellcheck.net/wiki/
#
# Shellcheck se configurează prin:
#   1. Comentarii în scripturi: # shellcheck disable=SC2034
#   2. Fișier .shellcheckrc în directorul rădăcină
#
# Creează .shellcheckrc cu:

[shellcheck_reference]
# Copiază acest conținut în .shellcheckrc (fără [shellcheck_reference])
#
# # Severitate minimă pentru raportare
# # Opțiuni: error, warning, info, style
# severity = "warning"
#
# # Shell implicit
# shell = "bash"
#
# # Coduri de dezactivat global
# # SC2034 - variabilă aparent nefolosită (probleme cu culorile)
# # SC2155 - declare și assign simultan
# # SC1091 - nu poate urma source-uri
# disable = SC2034,SC1091
#
# # Surse externe de verificat
# source-path = SCRIPTDIR
#
# # Activează verificări opționale
# enable = all

# ═══════════════════════════════════════════════════════════════════════════════
# PYLINT - Python Linter Extensiv (opțional)
# ═══════════════════════════════════════════════════════════════════════════════

[tool.pylint.main]
# Extensii de fișiere Python
py-version = "3.9"

[tool.pylint.format]
max-line-length = 100

[tool.pylint.messages_control]
disable = [
    "C0114",  # missing-module-docstring
    "C0115",  # missing-class-docstring
    "C0116",  # missing-function-docstring
    "R0903",  # too-few-public-methods
    "R0913",  # too-many-arguments
    "W0621",  # redefined-outer-name
]

# ═══════════════════════════════════════════════════════════════════════════════
# MYPY - Type Checking (opțional)
# ═══════════════════════════════════════════════════════════════════════════════

[tool.mypy]
python_version = "3.9"
warn_return_any = true
warn_unused_configs = true
ignore_missing_imports = true

# ═══════════════════════════════════════════════════════════════════════════════
# CODURI SHELLCHECK COMUNE ȘI EXPLICAȚII
# ═══════════════════════════════════════════════════════════════════════════════
#
# SC2034 - variabilă atribuită dar nefolosită
#          Frecvent cu variabile de culoare definite pentru uz ulterior
#          Rezolvare: # shellcheck disable=SC2034
#
# SC2086 - double quote pentru a preveni globbing și word splitting
#          Exemplu: rm $file → rm "$file"
#
# SC2155 - declare și atribuire pe aceeași linie ascunde exit code
#          Exemplu: local var=$(cmd) → local var; var=$(cmd)
#
# SC2164 - use cd ... || exit în caz de eșec
#          Exemplu: cd /dir → cd /dir || exit 1
#
# SC2181 - verifică direct comanda în loc de $?
#          Exemplu: cmd; if [ $? -eq 0 ] → if cmd; then
#
# SC1091 - nu poate urma fișier source (inexistent sau extern)
#          Frecvent cu source de scripturi dinamice
#
# SC2002 - useless cat
#          Exemplu: cat file | grep → grep file
#
# ═══════════════════════════════════════════════════════════════════════════════
# FIN
# ═══════════════════════════════════════════════════════════════════════════════
