# SO - ExerciÈ›ii, Diagrame È™i ÃntrebÄƒri de Examen

## Partea 3: SÄƒptÄƒmÃ¢nile 9-14 (Memorie, Sisteme de fiÈ™iere, Securitate, Virtualizare)

> by Revolvix | ASE BucureÈ™ti - CSIE

### LegendÄƒ de dificultate

| Simbol | Nivel | Timp | Descriere |
|--------|-------|------|-----------|
| â­ | UÈ™or | 3â€“5 min | Reamintire È™i Ã®nÈ›elegere de bazÄƒ |
| â­â­ | Mediu | 5â€“10 min | Aplicarea conceptelor |
| â­â­â­ | Dificil | 10â€“15 min | AnalizÄƒ È™i calcul |
| â­â­â­â­ | Expert | 15â€“20 min | Evaluare È™i proiectare |

> ğŸ’¡ **Sfat de studiu:** ParcurgeÈ›i exerciÈ›iile fÄƒrÄƒ a consulta soluÈ›iile din prima Ã®ncercare. CronometraÈ›i-vÄƒ â€” Ã®ntrebÄƒrile de examen ar trebui sÄƒ dureze aproximativ 5 minute fiecare.



---

# SÄ‚PTÄ‚MÃ‚NA 9: Gestiunea Memoriei I

## Diagrame ASCII Detaliate

### Diagrama 9.1: SpaÈ›iul de Adrese Virtual Complet

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    SPAÈšIUL DE ADRESE VIRTUAL (64-bit Linux)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AdresÄƒ                                                              Dimensiune
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

0xFFFFFFFFFFFFFFFF â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚                                                 â”‚
                   â”‚              KERNEL SPACE                       â”‚  ~128 TB
                   â”‚                                                 â”‚
                   â”‚  â€¢ Codul kernelului                            â”‚
                   â”‚  â€¢ Structuri de date kernel                    â”‚
                   â”‚  â€¢ Drivere                                      â”‚
                   â”‚  â€¢ Page tables (kernel)                        â”‚
                   â”‚  â€¢ Direct mapped physical memory               â”‚
                   â”‚                                                 â”‚
0xFFFF800000000000 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                   â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚
                   â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ NON-CANONICAL â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚
                   â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚
                   â”‚  (Adrese invalide - gap de 16M TB)             â”‚
                   â”‚  Accesul aici â†’ SEGMENTATION FAULT             â”‚
                   â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚
0x0000800000000000 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                   â”‚                                                 â”‚
                   â”‚              USER SPACE                         â”‚  ~128 TB
                   â”‚                                                 â”‚
0x00007FFFFFFFFFFF â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                   â”‚ â”‚              STACK                         â”‚  â”‚
                   â”‚ â”‚  â€¢ Variabile locale                       â”‚  â”‚  ~8 MB
                   â”‚ â”‚  â€¢ Parametri funcÈ›ii                      â”‚  â”‚  (default)
                   â”‚ â”‚  â€¢ Adrese de return                       â”‚  â”‚
                   â”‚ â”‚                    â†“ creÈ™te Ã®n jos         â”‚  â”‚
                   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                   â”‚              â”‚                                  â”‚
                   â”‚              â”‚  (spaÈ›iu nealocat)              â”‚
                   â”‚              â”‚                                  â”‚
                   â”‚              â”‚                                  â”‚
                   â”‚              â–¼                                  â”‚
                   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                   â”‚ â”‚         MEMORY MAPPED FILES               â”‚  â”‚
                   â”‚ â”‚  â€¢ Biblioteci partajate (.so)             â”‚  â”‚  Variabil
                   â”‚ â”‚  â€¢ mmap() regions                         â”‚  â”‚
                   â”‚ â”‚  â€¢ Shared memory                          â”‚  â”‚
                   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                   â”‚              â”‚                                  â”‚
                   â”‚              â”‚  (spaÈ›iu nealocat)              â”‚
                   â”‚              â”‚                                  â”‚
                   â”‚              â–²                                  â”‚
                   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                   â”‚ â”‚              HEAP                          â”‚  â”‚
                   â”‚ â”‚  â€¢ malloc(), new                          â”‚  â”‚  Variabil
                   â”‚ â”‚  â€¢ Alocare dinamicÄƒ                       â”‚  â”‚
                   â”‚ â”‚                    â†‘ creÈ™te Ã®n sus         â”‚  â”‚
                   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                   â”‚ â”€ â”€ â”€ â”€ â”€ â”€ program break (brk) â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”‚
                   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                   â”‚ â”‚              BSS                           â”‚  â”‚
                   â”‚ â”‚  â€¢ Variabile globale neiniÈ›ializate       â”‚  â”‚  Fix
                   â”‚ â”‚  â€¢ IniÈ›ializate cu 0 de SO               â”‚  â”‚
                   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                   â”‚ â”‚              DATA                          â”‚  â”‚
                   â”‚ â”‚  â€¢ Variabile globale iniÈ›ializate         â”‚  â”‚  Fix
                   â”‚ â”‚  â€¢ Constante string                       â”‚  â”‚
                   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                   â”‚ â”‚              TEXT (CODE)                   â”‚  â”‚
                   â”‚ â”‚  â€¢ InstrucÈ›iuni executabile               â”‚  â”‚  Fix
                   â”‚ â”‚  â€¢ Read-only, executable                  â”‚  â”‚
                   â”‚ â”‚  â€¢ Partajat Ã®ntre procese (fork)          â”‚  â”‚
0x0000000000400000 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                   â”‚                                                 â”‚
                   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                   â”‚ â”‚              RESERVED                      â”‚  â”‚
0x0000000000000000 â”‚ â”‚  â€¢ NULL pointer region                    â”‚  â”‚  ~4 MB
                   â”‚ â”‚  â€¢ Accesul aici â†’ SIGSEGV                 â”‚  â”‚
                   â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VIZUALIZARE ÃN LINUX: cat /proc/PID/maps
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

$ cat /proc/self/maps

00400000-00452000 r-xp 00000000 08:01 123456  /bin/cat          â† TEXT
00651000-00652000 r--p 00051000 08:01 123456  /bin/cat          â† DATA (ro)
00652000-00653000 rw-p 00052000 08:01 123456  /bin/cat          â† DATA (rw)
00653000-00674000 rw-p 00000000 00:00 0       [heap]            â† HEAP
7f1234560000-... r-xp 00000000 08:01 789012  /lib/libc-2.31.so â† SHARED LIB
...
7ffc12340000-7ffc12361000 rw-p 00000000 00:00 0 [stack]        â† STACK
7ffc123fe000-7ffc12400000 r-xp 00000000 00:00 0 [vdso]         â† VDSO

Permisiuni: r=read, w=write, x=execute, p=private, s=shared
```

### Diagrama 9.2: Mecanismul de Paginare

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    TRADUCEREA ADRESEI CU PAGINARE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ADRESÄ‚ VIRTUALÄ‚ (32 biÈ›i, pagini de 4KB):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Page Number             â”‚        Offset          â”‚
â”‚          (20 biÈ›i)              â”‚       (12 biÈ›i)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         bits 31-12                      bits 11-0

De ce 12 biÈ›i pentru offset?
  4KB = 4096 bytes = 2^12 â†’ 12 biÈ›i pentru a adresa orice byte Ã®n paginÄƒ

De ce 20 biÈ›i pentru page number?
  32 - 12 = 20 biÈ›i â†’ 2^20 = 1M pagini posibile

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PROCESUL DE TRADUCERE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    ADRESA VIRTUALÄ‚: 0x00003ABC
                    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    
   Binar: 0000 0000 0000 0000 0011 1010 1011 1100
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                Page Number             Offset
                  0x00003               0xABC
                  (pagina 3)            (2748)

                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PAGE TABLE                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Index    â”‚ Frame Number â”‚ Control Bits                            â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚     0     â”‚     0x0A5    â”‚   V   â”‚  R/W  â”‚  U/S  â”‚   A   â”‚   D     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚     1     â”‚     0x123    â”‚   1   â”‚   1   â”‚   1   â”‚   0   â”‚   0     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚     2     â”‚     0x000    â”‚   0   â”‚   -   â”‚   -   â”‚   -   â”‚   -     â”‚ â”‚ â† INVALID!
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ â†’   3   â† â”‚   â†’ 0x0F7 â† â”‚   1   â”‚   1   â”‚   1   â”‚   1   â”‚   0     â”‚ â”‚ â† FOLOSIM ASTA!
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚    ...    â”‚     ...      â”‚  ...  â”‚  ...  â”‚  ...  â”‚  ...  â”‚  ...    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â”‚  Control Bits:                                                           â”‚
â”‚  V = Valid (pagina Ã®n memorie)                                          â”‚
â”‚  R/W = Read/Write (0=read-only, 1=read+write)                           â”‚
â”‚  U/S = User/Supervisor (0=kernel only, 1=user accessible)               â”‚
â”‚  A = Accessed (a fost cititÄƒ/scrisÄƒ recent)                             â”‚
â”‚  D = Dirty (a fost modificatÄƒ)                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ Frame Number = 0x0F7 (247)
                           â”‚
                           â–¼
                    ADRESA FIZICÄ‚
                    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    
   Frame Number (0x0F7) Ã— Page Size (0x1000) + Offset (0xABC)
   = 0x0F7 Ã— 0x1000 + 0xABC
   = 0x0F7000 + 0xABC
   = 0x0F7ABC

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Frame Number              â”‚        Offset          â”‚
â”‚         0x0F7                   â”‚        0xABC           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    = 0x0F7ABC

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VIZUALIZARE MEMORIA FIZICÄ‚:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Memoria FizicÄƒ (Frame-uri):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frame 0   â”‚  Frame 1   â”‚  ...  â”‚ Frame 247  â”‚  ...  â”‚  Frame N   â”‚     â”‚
â”‚  (0x0A5)   â”‚  (0x123)   â”‚       â”‚  (0x0F7)   â”‚       â”‚            â”‚     â”‚
â”‚            â”‚            â”‚       â”‚            â”‚       â”‚            â”‚     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚            â”‚     â”‚
â”‚ â”‚  P0    â”‚ â”‚ â”‚  P1    â”‚ â”‚       â”‚ â”‚  P0    â”‚ â”‚       â”‚            â”‚     â”‚
â”‚ â”‚  pg 0  â”‚ â”‚ â”‚  pg 1  â”‚ â”‚       â”‚ â”‚  pg 3  â”‚ â”‚       â”‚            â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚            â”‚     â”‚
â”‚            â”‚            â”‚       â”‚     â†‘      â”‚       â”‚            â”‚     â”‚
â”‚            â”‚            â”‚       â”‚ offset ABC â”‚       â”‚            â”‚     â”‚
â”‚            â”‚            â”‚       â”‚ byte 2748  â”‚       â”‚            â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Diagrama 9.3: Page Table pe Mai Multe Niveluri

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    PAGE TABLE PE 2 NIVELURI (32-bit)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

De ce mai multe niveluri?
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

32-bit cu pagini 4KB:
- 2^20 = 1.048.576 intrÄƒri Ã®n page table
- Fiecare intrare: 4 bytes
- Total: 4 MB per proces DOAR pentru page table!
- Majoritatea intrÄƒrilor: NEFOLOSITE!

SoluÈ›ie: PaginÄƒm È™i page table-ul!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ADRESÄ‚ VIRTUALÄ‚ (32 biÈ›i):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Page Directoryâ”‚   Page Table   â”‚        Offset          â”‚
â”‚    Index       â”‚     Index      â”‚                        â”‚
â”‚   (10 biÈ›i)    â”‚   (10 biÈ›i)    â”‚       (12 biÈ›i)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   bits 31-22       bits 21-12          bits 11-0

         CPU                           MEMORIA FIZICÄ‚
         â•â•â•                           â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Adresa VirtualÄƒ â”‚
â”‚   0x08049ABC    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Extrage: PD_index=0x020, PT_index=0x049, Offset=0xABC
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     
â”‚  CR3 Register   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (Page Dir Base) â”‚                    â”‚
â”‚    0x00123000   â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                                       â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚         PAGE DIRECTORY               â”‚
                        â”‚  (1024 intrÄƒri Ã— 4 bytes = 4KB)     â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
                        â”‚  â”‚ Index â”‚ PT Address â”‚ Flags      â”‚â”‚
                        â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
                        â”‚  â”‚   0   â”‚ 0x00200000 â”‚ P,R/W,U/S  â”‚â”‚
                        â”‚  â”‚  ...  â”‚    ...     â”‚    ...     â”‚â”‚
                        â”‚  â”‚â†’ 32 â† â”‚â†’0x00456000 â”‚ Present=1  â”‚â”‚ â† Folosim!
                        â”‚  â”‚  ...  â”‚    ...     â”‚    ...     â”‚â”‚
                        â”‚  â”‚ 1023  â”‚ 0x00789000 â”‚    ...     â”‚â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ PT Address = 0x00456000
                                       â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚           PAGE TABLE                 â”‚
                        â”‚  (1024 intrÄƒri Ã— 4 bytes = 4KB)     â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
                        â”‚  â”‚ Index â”‚ Frame Addr â”‚ Flags      â”‚â”‚
                        â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
                        â”‚  â”‚   0   â”‚ 0x0ABC0000 â”‚ P,R/W,U/S  â”‚â”‚
                        â”‚  â”‚  ...  â”‚    ...     â”‚    ...     â”‚â”‚
                        â”‚  â”‚â†’ 73 â† â”‚â†’0x00F70000 â”‚ Present=1  â”‚â”‚ â† Folosim!
                        â”‚  â”‚  ...  â”‚    ...     â”‚    ...     â”‚â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ Frame Address = 0x00F70000
                                       â”‚ + Offset 0xABC
                                       â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚         ADRESA FIZICÄ‚                â”‚
                        â”‚           0x00F70ABC                 â”‚
                        â”‚                                      â”‚
                        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                        â”‚    â”‚     Frame 0x00F70          â”‚   â”‚
                        â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
                        â”‚    â”‚  â”‚   byte @ 0xABC       â”‚  â”‚   â”‚
                        â”‚    â”‚  â”‚   (offset 2748)      â”‚  â”‚   â”‚
                        â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
                        â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
AVANTAJ: ECONOMIE DE MEMORIE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Proces care foloseÈ™te doar 8MB de memorie:
- Cu un nivel: 4MB page table (1M intrÄƒri) â€” È™i legat de asta, cu douÄƒ niveluri:
  - 1 Page Directory: 4KB
  - ~2 Page Tables pentru 8MB: 2 Ã— 4KB = 8KB
  - Total: ~12KB Ã®n loc de 4MB!

Page Tables pentru regiuni nefolosite: NU SE ALOCÄ‚!
```

---

## ExerciÈ›ii Rezolvate

### ExerciÈ›iul 9.1: Calculul Adresei Fizice

ProblemÄƒ: Un sistem are:
- Adrese virtuale pe 32 biÈ›i
- Pagini de 8KB
- AdresÄƒ virtualÄƒ: 0x00005A3C

GÄƒseÈ™te: page number, offset, È™i adresa fizicÄƒ dacÄƒ pagina 2 este mapatÄƒ la frame-ul 7.

SoluÈ›ie:

```
1. DeterminÄƒm biÈ›ii pentru offset:
   Page size = 8KB = 8192 = 2^13 bytes
   â†’ Offset: 13 biÈ›i

2. DeterminÄƒm biÈ›ii pentru page number:
   32 - 13 = 19 biÈ›i pentru page number

3. Descompunem adresa virtualÄƒ 0x00005A3C:
   
   Binar: 0000 0000 0000 0000 0101 1010 0011 1100
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           Page Number (19 biÈ›i)   Offset (13 biÈ›i)
   
   Hex: 0x00005A3C
   - Page Number: 0x00005A3C >> 13 = 0x00005A3C / 8192 = 2 (pagina 2)
   - Offset: 0x00005A3C & 0x1FFF = 0x1A3C (6716 Ã®n decimal)

4. CalculÄƒm adresa fizicÄƒ:
   Frame 7 Ã— 8KB + Offset
   = 7 Ã— 8192 + 6716
   = 57344 + 6716
   = 64060
   = 0xFA3C

   Sau: (Frame << 13) | Offset = (7 << 13) | 0x1A3C = 0xFA3C

RÄ‚SPUNS:
- Page Number: 2
- Offset: 0x1A3C (6716)
- Adresa fizicÄƒ: 0x0000FA3C
```

---

### ExerciÈ›iul 9.2: Dimensiunea Page Table

ProblemÄƒ: CalculeazÄƒ dimensiunea page table pentru:
- SpaÈ›iu de adrese: 32 biÈ›i
- Dimensiune paginÄƒ: 4KB
- Dimensiune intrare PT: 4 bytes
- SalveazÄƒ o copie de backup pentru siguranÈ›Äƒ

SoluÈ›ie:

```
1. NumÄƒrul total de pagini:
   SpaÈ›iu adrese = 2^32 bytes = 4GB
   Dimensiune paginÄƒ = 4KB = 2^12 bytes
   NumÄƒr pagini = 2^32 / 2^12 = 2^20 = 1,048,576 pagini

2. Dimensiunea page table:
   NumÄƒr pagini Ã— Dimensiune intrare
   = 2^20 Ã— 4 bytes
   = 4,194,304 bytes
   = 4 MB

RÄ‚SPUNS: 4 MB per proces (doar pentru page table!)

ObservaÈ›ie: Aceasta e problema principalÄƒ care motiveazÄƒ:
- Page tables pe mai multe niveluri
- Inverted page tables
```

---

## ÃntrebÄƒri Tip Examen

9.1 (GrilÄƒ) MMU (Memory Management Unit) este responsabil pentru:
- a) Alocarea memoriei heap
- b) Traducerea adreselor virtuale Ã®n fizice âœ“
- c) Garbage collection
- d) Compactarea memoriei

---

9.2 (GrilÄƒ) Fragmentarea internÄƒ apare cÃ¢nd:
- a) ExistÄƒ spaÈ›ii libere necontigue
- b) Memoria alocatÄƒ este mai mare decÃ¢t cea necesarÄƒ âœ“
- c) Page table-ul e prea mare
- d) TLB are miss

---

9.3 (5p) ExplicÄƒ diferenÈ›a dintre fragmentare internÄƒ È™i externÄƒ, dÃ¢nd exemple concrete.

RÄƒspuns model:

| Tip | Fragmentare InternÄƒ | Fragmentare ExternÄƒ |
|-----|---------------------|---------------------|
| DefiniÈ›ie | Memoria alocatÄƒ > memoria necesarÄƒ | Memoria liberÄƒ e fragmentatÄƒ Ã®n bucÄƒÈ›i mici necontigue |
| CauzÄƒ | Alocare Ã®n blocuri fixe | Alocare/dealocare Ã®n blocuri de dimensiuni diferite |
| Exemplu | Proces cere 3.5KB, primeÈ™te paginÄƒ de 4KB â†’ 0.5KB pierdut | 10MB liber dar Ã®n bucÄƒÈ›i de 1MB; nu poÈ›i aloca 5MB contiguu |
| SoluÈ›ie | Dimensiuni variabile (dar creÈ™te complexitatea) | Compactare (costisitoare) sau Paginare |
| Cu paginare | ExistÄƒ (ultima paginÄƒ parÈ›ial utilizatÄƒ) | EliminatÄƒ complet! |

---

# SÄ‚PTÄ‚MÃ‚NA 10: Memorie virtualÄƒ (TLB, Ã®nlocuirea paginilor)

## Diagrame ASCII Detaliate

### Diagrama 10.1: TLB È™i Accesul la Memorie

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    TLB (TRANSLATION LOOKASIDE BUFFER)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                         CPU genereazÄƒ adresÄƒ virtualÄƒ
                                     â”‚
                                     â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚    Adresa VirtualÄƒ      â”‚
                        â”‚    Page# = 0x0123       â”‚
                        â”‚    Offset = 0x456       â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                                           â”‚
              â–¼                                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚              TLB                     â”‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                   â”‚
â”‚  â”‚  Tag    â”‚  Frame  â”‚  Valid  â”‚   â”‚                   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚                   â”‚
â”‚  â”‚  0x0100 â”‚  0x0A5  â”‚    1    â”‚   â”‚                   â”‚
â”‚  â”‚  0x0123 â”‚  0x0F7  â”‚    1    â”‚ â† HIT!               â”‚
â”‚  â”‚  0x0456 â”‚  0x123  â”‚    1    â”‚   â”‚                   â”‚
â”‚  â”‚  0x0789 â”‚  0x000  â”‚    0    â”‚   â”‚                   â”‚
â”‚  â”‚   ...   â”‚   ...   â”‚   ...   â”‚   â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                   â”‚
â”‚                                     â”‚                   â”‚
â”‚  CÄƒutare: O(1) - paralel!          â”‚                   â”‚
â”‚  Dimensiune tipicÄƒ: 64-1024 intrÄƒri â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
               â”‚                                           â”‚
               â”‚                                           â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
      â”‚                 â”‚                                 â”‚
      â–¼                 â–¼                                 â”‚
  TLB HIT          TLB MISS                              â”‚
  â•â•â•â•â•â•â•â•         â•â•â•â•â•â•â•â•                              â”‚
      â”‚                 â”‚                                 â”‚
      â”‚                 â”‚  ConsultÄƒ Page Table           â”‚
      â”‚                 â”‚  (1-4 accesuri memorie!)       â”‚
      â”‚                 â–¼                                 â”‚
      â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
      â”‚    â”‚             PAGE TABLE                   â”‚   â”‚
      â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
      â”‚    â”‚  â”‚  VPage  â”‚  Frame  â”‚  Flags  â”‚       â”‚   â”‚
      â”‚    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚   â”‚
      â”‚    â”‚  â”‚  0x0123 â”‚  0x0F7  â”‚ Present â”‚       â”‚   â”‚
      â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
      â”‚    â”‚                                         â”‚   â”‚
      â”‚    â”‚  â†’ ActualizeazÄƒ TLB cu noua mapare     â”‚   â”‚
      â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
      â”‚                 â”‚                                 â”‚
      â”‚                 â”‚                                 â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
               â”‚                                           â”‚
               â”‚ Frame# = 0x0F7                           â”‚
               â–¼                                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ADRESA FIZICÄ‚                          â”‚
â”‚                                                          â”‚
â”‚   Frame# (0x0F7) Ã— PageSize + Offset (0x456)            â”‚
â”‚   = 0x0F7456                                             â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MEMORIA FIZICÄ‚                          â”‚
â”‚                                                          â”‚
â”‚   Acces la adresa fizicÄƒ 0x0F7456                       â”‚
â”‚   â†’ ReturneazÄƒ datele                                    â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CALCUL EAT (EFFECTIVE ACCESS TIME):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fie:
- TLB access time: Îµ (ex: 1 ns)
- Memory access time: m (ex: 100 ns)
- TLB hit ratio: Î± (ex: 0.98)

EAT = Î± Ã— (Îµ + m) + (1 - Î±) Ã— (Îµ + 2m)
      â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯   â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
        TLB hit          TLB miss
      (TLB + mem)    (TLB + PT + mem)

Cu Î± = 0.98, Îµ = 1 ns, m = 100 ns:
EAT = 0.98 Ã— (1 + 100) + 0.02 Ã— (1 + 200)
    = 0.98 Ã— 101 + 0.02 Ã— 201
    = 98.98 + 4.02
    = 103 ns

FÄƒrÄƒ TLB: 200 ns (2 accesuri memorie)
Cu TLB: 103 ns â†’ ~49% reducere!
```

### Diagrama 10.2: Algoritmi de Ãnlocuire Pagini - ComparaÈ›ie

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ALGORITMI DE ÃNLOCUIRE PAGINI - EXEMPLU COMPARATIV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Reference String: 7, 0, 1, 2, 0, 3, 0, 4, 2, 3, 0, 3, 2, 1, 2, 0, 1, 7, 0, 1
NumÄƒr de frame-uri: 3

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FIFO (First-In, First-Out):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ref: 7  0  1  2  0  3  0  4  2  3  0  3  2  1  2  0  1  7  0  1
    â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
F0: â”‚7 â”‚7 â”‚7 â”‚2 â”‚2 â”‚2 â”‚2 â”‚4 â”‚4 â”‚4 â”‚0 â”‚0 â”‚0 â”‚1 â”‚1 â”‚1 â”‚1 â”‚7 â”‚7 â”‚7 â”‚
    â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
F1: â”‚- â”‚0 â”‚0 â”‚0 â”‚0 â”‚3 â”‚3 â”‚3 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚
    â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
F2: â”‚- â”‚- â”‚1 â”‚1 â”‚1 â”‚1 â”‚0 â”‚0 â”‚0 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚1 â”‚1 â”‚1 â”‚1 â”‚
    â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
    PF:âœ“  âœ“  âœ“  âœ“     âœ“  âœ“  âœ“  âœ“  âœ“  âœ“        âœ“     âœ“  âœ“  âœ“      

Total Page Faults: 15

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
OPT (Optimal - È˜tie Viitorul):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ref: 7  0  1  2  0  3  0  4  2  3  0  3  2  1  2  0  1  7  0  1
    â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
F0: â”‚7 â”‚7 â”‚7 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚7 â”‚7 â”‚7 â”‚
    â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
F1: â”‚- â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚4 â”‚4 â”‚3 â”‚3 â”‚3 â”‚3 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚
    â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
F2: â”‚- â”‚- â”‚1 â”‚1 â”‚1 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚
    â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
    PF:âœ“  âœ“  âœ“  âœ“     âœ“     âœ“     âœ“  âœ“        âœ“              âœ“      

Total Page Faults: 9 (OPTIMAL - minimum posibil)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LRU (Least Recently Used):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ref: 7  0  1  2  0  3  0  4  2  3  0  3  2  1  2  0  1  7  0  1
    â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
F0: â”‚7 â”‚7 â”‚7 â”‚2 â”‚2 â”‚2 â”‚2 â”‚4 â”‚4 â”‚4 â”‚0 â”‚0 â”‚0 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚
    â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
F1: â”‚- â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚0 â”‚0 â”‚0 â”‚0 â”‚0 â”‚
    â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤
F2: â”‚- â”‚- â”‚1 â”‚1 â”‚1 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚7 â”‚7 â”‚7 â”‚
    â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
    PF:âœ“  âœ“  âœ“  âœ“     âœ“     âœ“  âœ“     âœ“        âœ“     âœ“     âœ“      

Total Page Faults: 12

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SUMAR COMPARATIV:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Algoritm  â”‚ Page Faultsâ”‚ Caracteristici                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  FIFO     â”‚     15     â”‚ Simplu, dar poate evacua pagini utile          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  OPT      â”‚      9     â”‚ Optimal teoretic, dar imposibil practic        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LRU      â”‚     12     â”‚ BunÄƒ aproximare a OPT, overhead de implementareâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ÃmbunÄƒtÄƒÈ›ire LRU vs FIFO: (15-12)/15 = 20% mai puÈ›ine page faults
LRU este 12/9 = 1.33x mai multe faults decÃ¢t OPT (33% overhead)
```

### Diagrama 10.3: Algoritmul Clock (Second Chance)

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    ALGORITMUL CLOCK (SECOND CHANCE)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

StructurÄƒ: Buffer circular cu pointer (acul ceasului)
Fiecare paginÄƒ are un "Reference Bit" (R)
- R=1: Pagina a fost accesatÄƒ recent
- R=0: Pagina nu a fost accesatÄƒ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STARE INIÈšIALÄ‚ (4 frame-uri):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Frame 0    â”‚
                    â”‚   Page: A     â”‚
                    â”‚    R = 1      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    Frame 3    â”‚   â”‚   â”‚    Frame 1    â”‚
        â”‚   Page: D     â”‚â”€â”€â”€â”´â”€â”€â”€â”‚   Page: B     â”‚
        â”‚    R = 0      â”‚       â”‚    R = 1      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚               â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Frame 2    â”‚
                    â”‚   Page: C     â”‚
                    â”‚    R = 0      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–²
                         â”‚
                      POINTER
                   (acul ceasului)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PAGE FAULT: Trebuie sÄƒ Ã®nlocuim o paginÄƒ cu noua paginÄƒ E
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Algoritm:
1. VerificÄƒ pagina la pointer
2. DacÄƒ R=0 â†’ Ã®nlocuieÈ™te È™i avanseazÄƒ
3. DacÄƒ R=1 â†’ seteazÄƒ R=0 (dÄƒ a doua È™ansÄƒ), avanseazÄƒ, repetÄƒ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PAS 1: Pointer la Frame 2, Page C
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        VerificÄƒm: Page C, R = 0 
        â†’ R=0, deci ÃNLOCUIM!
        â†’ Frame 2 primeÈ™te Page E
        â†’ AvansÄƒm pointer la Frame 3

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Frame 0    â”‚
                    â”‚   Page: A     â”‚
                    â”‚    R = 1      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    Frame 3    â”‚       â”‚    Frame 1    â”‚
        â”‚   Page: D     â”‚â”€â”€â”€â”€â”€â”€â”€â”‚   Page: B     â”‚
        â”‚    R = 0      â”‚       â”‚    R = 1      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â–²                          
             â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          POINTER           â”‚    Frame 2    â”‚
                           â”‚   Page: E     â”‚  â† NOU!
                           â”‚    R = 1      â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EXEMPLU: Page Fault pentru pagina F (simulare completÄƒ)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Stare: Toate R=1 (toate paginile recent accesate)
       Pointer la Frame 0

        PAS 1:                  PAS 2:                  PAS 3:
        Frame 0, A, R=1         Frame 1, B, R=1         Frame 2, E, R=1
        â†’ R=1, setÄƒm R=0        â†’ R=1, setÄƒm R=0        â†’ R=1, setÄƒm R=0
        â†’ AvansÄƒm               â†’ AvansÄƒm               â†’ AvansÄƒm
        
        PAS 4:                  PAS 5:
        Frame 3, D, R=1         Frame 0, A, R=0
        â†’ R=1, setÄƒm R=0        â†’ R=0, ÃNLOCUIM!
        â†’ AvansÄƒm               â†’ A Ã®nlocuit cu F

DupÄƒ o rotaÈ›ie completÄƒ, prima paginÄƒ (A) a pierdut 
"a doua È™ansÄƒ" È™i este Ã®nlocuitÄƒ.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VARIANTA ÃMBUNÄ‚TÄ‚ÈšITÄ‚: CLOCK CU DIRTY BIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PreferinÈ›Äƒ pentru evacuarea paginilor CLEAN (nu trebuie scrise pe disc):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     R      â”‚     D      â”‚ Decizie                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     0      â”‚     0      â”‚ Cel mai bun candidat (nefolosit, curat)       â”‚
â”‚     0      â”‚     1      â”‚ Bun candidat (nefolosit, dar trebuie scris)   â”‚
â”‚     1      â”‚     0      â”‚ Slab candidat (folosit recent)                â”‚
â”‚     1      â”‚     1      â”‚ Cel mai slab candidat (folosit + dirty)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ExerciÈ›ii Rezolvate

### ExerciÈ›iul 10.1: Calcul EAT cu TLB pe Mai Multe Niveluri

ProblemÄƒ: Un sistem are:
- Page table pe 2 niveluri
- TLB access: 2 ns
- Memory access: 80 ns
- TLB hit rate: 95%

CalculeazÄƒ EAT.

SoluÈ›ie:

```
Cu 2 niveluri de page table, un TLB miss necesitÄƒ 3 accesuri memorie:
1. Page Directory
2. Page Table
3. Datele efective

EAT = P(TLB hit) Ã— T(TLB hit) + P(TLB miss) Ã— T(TLB miss)

T(TLB hit) = TLB access + 1 Ã— Memory access
           = 2 + 80 = 82 ns

T(TLB miss) = TLB access + 3 Ã— Memory access
            = 2 + 3Ã—80 = 2 + 240 = 242 ns

EAT = 0.95 Ã— 82 + 0.05 Ã— 242
    = 77.9 + 12.1
    = 90 ns

ComparaÈ›ie:
- FÄƒrÄƒ TLB: 3 Ã— 80 = 240 ns
- Cu TLB: 90 ns
- Speedup: 240/90 = 2.67x
```

---

### ExerciÈ›iul 10.2: Simulare FIFO È™i LRU

ProblemÄƒ: Reference string: 1, 2, 3, 4, 1, 2, 5, 1, 2, 3, 4, 5
Frame-uri: 3
CalculeazÄƒ page faults pentru FIFO È™i LRU.

SoluÈ›ie:

```
FIFO:
â•â•â•â•â•
Ref: 1  2  3  4  1  2  5  1  2  3  4  5
    â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
F0: â”‚1 â”‚1 â”‚1 â”‚4 â”‚4 â”‚4 â”‚5 â”‚5 â”‚5 â”‚5 â”‚5 â”‚5 â”‚
F1: â”‚- â”‚2 â”‚2 â”‚2 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚3 â”‚3 â”‚3 â”‚
F2: â”‚- â”‚- â”‚3 â”‚3 â”‚3 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚4 â”‚4 â”‚
    â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
PF:  âœ“  âœ“  âœ“  âœ“  âœ“  âœ“  âœ“        âœ“  âœ“    

FIFO Page Faults: 9

LRU:
â•â•â•â•
Ref: 1  2  3  4  1  2  5  1  2  3  4  5
    â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
F0: â”‚1 â”‚1 â”‚1 â”‚4 â”‚4 â”‚4 â”‚5 â”‚5 â”‚5 â”‚3 â”‚3 â”‚3 â”‚
F1: â”‚- â”‚2 â”‚2 â”‚2 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚4 â”‚4 â”‚
F2: â”‚- â”‚- â”‚3 â”‚3 â”‚3 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚5 â”‚
    â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
PF:  âœ“  âœ“  âœ“  âœ“  âœ“  âœ“  âœ“        âœ“  âœ“  âœ“

LRU Page Faults: 10

SURPRIZÄ‚! Ãn acest caz FIFO (9) < LRU (10)!
(Aceasta nu e anomalia Belady - asta e doar o situaÈ›ie particularÄƒ
unde FIFO s-a Ã®ntÃ¢mplat sÄƒ performeze mai bine pentru acest pattern)
```

---

## ÃntrebÄƒri Tip Examen

10.1 (GrilÄƒ) Thrashing apare cÃ¢nd:
- a) TLB-ul e prea mic
- b) Procesul petrece mai mult timp Ã®n page faults decÃ¢t executÃ¢nd âœ“
- c) Dimensiunea paginii e prea mare
- d) Page table-ul e pe un singur nivel

---

10.2 (7p) ExplicÄƒ anomalia Belady È™i demonstreazÄƒ-o cu un exemplu.

RÄƒspuns:

```
ANOMALIA BELADY: Cu FIFO, MAI MULTE frame-uri pot cauza MAI MULTE page faults!

DemonstraÈ›ie cu reference string: 1, 2, 3, 4, 1, 2, 5, 1, 2, 3, 4, 5

Cu 3 frame-uri (calculat mai sus): 9 page faults

Cu 4 frame-uri:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Ref: 1  2  3  4  1  2  5  1  2  3  4  5
    â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
F0: â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚5 â”‚5 â”‚5 â”‚5 â”‚5 â”‚5 â”‚
F1: â”‚- â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚2 â”‚1 â”‚1 â”‚1 â”‚1 â”‚1 â”‚
F2: â”‚- â”‚- â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚3 â”‚2 â”‚2 â”‚2 â”‚2 â”‚
F3: â”‚- â”‚- â”‚- â”‚4 â”‚4 â”‚4 â”‚4 â”‚4 â”‚4 â”‚3 â”‚3 â”‚3 â”‚
    â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
PF:  âœ“  âœ“  âœ“  âœ“        âœ“  âœ“  âœ“  âœ“  âœ“  âœ“

Page Faults cu 4 frame-uri: 10

CONCLUZIE: 3 frame-uri â†’ 9 faults, 4 frame-uri â†’ 10 faults!
Mai multe resurse = performanÈ›Äƒ mai slabÄƒ (contraintuitiv!)

CAUZA: FIFO nu ia Ã®n calcul frecvenÈ›a/recentitatea accesului.
Poate evacua o paginÄƒ folositÄƒ frecvent doar pentru cÄƒ a fost 
Ã®ncÄƒrcatÄƒ prima.

SOLUÈšIA: LRU È™i OPT NU au anomalia Belady (sunt "stack algorithms").
```

---

# SÄ‚PTÄ‚MÃ‚NA 11â€“12: Sisteme de fiÈ™iere

## Diagrame ASCII Detaliate

### Diagrama 11.1: Structura Inode

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    STRUCTURA INODE (ext4)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           INODE #12345                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  METADATA (nu include numele fiÈ™ierului!)                         â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  Type & Mode:    -rw-r--r-- (regular file, 0644)                 â”‚ â”‚
â”‚  â”‚  Owner UID:      1000 (user)                                      â”‚ â”‚
â”‚  â”‚  Owner GID:      1000 (group)                                     â”‚ â”‚
â”‚  â”‚  Size:           15,847 bytes                                     â”‚ â”‚
â”‚  â”‚  Link Count:     2 (2 hard links pointeazÄƒ aici)                  â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  Timestamps:                                                       â”‚ â”‚
â”‚  â”‚    atime:  2024-01-15 10:30:00 (last access)                      â”‚ â”‚
â”‚  â”‚    mtime:  2024-01-14 15:20:00 (last modification)                â”‚ â”‚
â”‚  â”‚    ctime:  2024-01-14 15:20:00 (last inode change)                â”‚ â”‚
â”‚  â”‚    crtime: 2024-01-10 09:00:00 (creation time - ext4 only)        â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  Block Count:    16 (blocuri de 512 bytes = 8KB alocat)          â”‚ â”‚
â”‚  â”‚  Flags:          0x00080000 (extents used)                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  BLOCK POINTERS (adresele blocurilor de date)                     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  DIRECT BLOCKS (12 pointeri):                                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚  â”‚100â”‚101â”‚102â”‚103â”‚104â”‚105â”‚106â”‚107â”‚108â”‚109â”‚110â”‚111â”‚               â”‚ â”‚
â”‚  â”‚  â””â”€â”¬â”€â”´â”€â”¬â”€â”´â”€â”¬â”€â”´â”€â”¬â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â”‚    â”‚   â”‚   â”‚   â”‚                                                   â”‚ â”‚
â”‚  â”‚    â”‚   â”‚   â”‚   â””â”€â”€â–º Bloc 103 (4KB date)                          â”‚ â”‚
â”‚  â”‚    â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â–º Bloc 102 (4KB date)                          â”‚ â”‚
â”‚  â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Bloc 101 (4KB date)                          â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Bloc 100 (4KB date)                          â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  12 direct Ã— 4KB = 48KB maximum cu direct blocks                  â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  SINGLE INDIRECT POINTER:                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”                                                            â”‚ â”‚
â”‚  â”‚  â”‚200â”‚â”€â”€â”€â”€â”€â”€â–º Bloc 200 conÈ›ine pointeri:                         â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”˜        â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”                        â”‚ â”‚
â”‚  â”‚               â”‚1000â”‚1001â”‚1002â”‚1003â”‚ ... â”‚                        â”‚ â”‚
â”‚  â”‚               â””â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”€â”€â”€â”˜                        â”‚ â”‚
â”‚  â”‚                  â”‚    â”‚    â”‚    â”‚                                  â”‚ â”‚
â”‚  â”‚                  â–¼    â–¼    â–¼    â–¼                                  â”‚ â”‚
â”‚  â”‚               Date  Date  Date  Date                               â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  1 bloc indirect Ã— 1024 pointeri Ã— 4KB = 4MB adiÈ›ional            â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  DOUBLE INDIRECT POINTER:                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”                                                            â”‚ â”‚
â”‚  â”‚  â”‚300â”‚â”€â”€â–º Bloc cu pointeri â†’ Blocuri cu pointeri â†’ Date          â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”˜                                                            â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  1024 Ã— 1024 Ã— 4KB = 4GB adiÈ›ional                                â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  TRIPLE INDIRECT POINTER:                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”                                                            â”‚ â”‚
â”‚  â”‚  â”‚400â”‚â”€â”€â–º 3 niveluri de indirectare                              â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”˜                                                            â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  1024 Ã— 1024 Ã— 1024 Ã— 4KB = 4TB adiÈ›ional                        â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  DIMENSIUNE MAXIMÄ‚ FIÈ˜IER (blocuri 4KB):                               â”‚
â”‚  12Ã—4KB + 1024Ã—4KB + 1024Â²Ã—4KB + 1024Â³Ã—4KB â‰ˆ 4TB                       â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Diagrama 11.2: Hard Link vs Symbolic Link

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    HARD LINK vs SYMBOLIC LINK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
HARD LINK:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

$ echo "Hello" > original.txt
$ ln original.txt hardlink.txt
$ ls -li

12345 -rw-r--r-- 2 user group 6 Jan 15 10:00 original.txt
12345 -rw-r--r-- 2 user group 6 Jan 15 10:00 hardlink.txt
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    ACELAÈ˜I INODE! (12345)

   DIRECTOR /home/user                    INODE TABLE
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Entries:              â”‚            â”‚                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚            â”‚  Inode 12345:   â”‚
  â”‚  â”‚ original.txt     â”‚â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  Type: file     â”‚
  â”‚  â”‚ inode: 12345     â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”‚  Size: 6        â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚      â”‚  Links: 2 â—„â”€â”€â”€â”€â”€â”¼â”€â”€ Link count!
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚      â”‚  Blocks: [100]  â”‚
  â”‚  â”‚ hardlink.txt     â”‚â”€â”€â”¼â”€â”€â”€â”€â”€â”˜      â”‚                 â”‚
  â”‚  â”‚ inode: 12345     â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                                 â”‚
                                                 â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚    Block 100       â”‚
                                    â”‚  "Hello\n"         â”‚
                                    â”‚                    â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DupÄƒ $ rm original.txt:
- Link count: 2 â†’ 1
- Datele RÄ‚MÃ‚N! (link count > 0)
- hardlink.txt funcÈ›ioneazÄƒ normal
- DocumenteazÄƒ ce ai fÄƒcut pentru referinÈ›Äƒ ulterioarÄƒ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SYMBOLIC LINK:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

$ ln -s original.txt symlink.txt
$ ls -li

12345 -rw-r--r-- 1 user group  6 Jan 15 10:00 original.txt
67890 lrwxrwxrwx 1 user group 12 Jan 15 10:05 symlink.txt -> original.txt
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             INODE DIFERIT! (67890)
             Tip: l (link)

   DIRECTOR /home/user                    INODE TABLE
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Entries:              â”‚            â”‚  Inode 12345:   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚            â”‚  Type: file     â”‚
  â”‚  â”‚ original.txt     â”‚â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  Links: 1       â”‚
  â”‚  â”‚ inode: 12345     â”‚  â”‚            â”‚  Blocks: [100]  â”‚â”€â”€â–º "Hello\n"
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â”‚ symlink.txt      â”‚â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  Inode 67890:   â”‚
  â”‚  â”‚ inode: 67890     â”‚  â”‚            â”‚  Type: symlink  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚            â”‚  Links: 1       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚  Content:       â”‚
                                        â”‚  "original.txt" â”‚â”€â”€â–º CALEA!
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DupÄƒ $ rm original.txt:
- Inode 12345 È™ters (link count = 0)
- symlink.txt â†’ original.txt (BROKEN LINK!)
- $ cat symlink.txt â†’ Error: No such file

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
COMPARAÈšIE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Aspect         â”‚     Hard Link        â”‚     Symbolic Link        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Inode               â”‚ ACELAÈ˜I              â”‚ DIFERIT                  â”‚
â”‚ Cross-filesystem    â”‚ âŒ Nu                â”‚ âœ… Da                    â”‚
â”‚ Link la directoare  â”‚ âŒ Nu (cicli!)       â”‚ âœ… Da                    â”‚
â”‚ La È™tergere target  â”‚ Datele rÄƒmÃ¢n         â”‚ Link broken              â”‚
â”‚ SpaÈ›iu ocupat       â”‚ Doar dir entry       â”‚ Dir entry + inode nou    â”‚
â”‚ Permisiuni          â”‚ Cele ale fiÈ™ierului  â”‚ 777 (irelevant)          â”‚
â”‚ PerformanÈ›Äƒ         â”‚ O singurÄƒ cÄƒutare    â”‚ Rezolvare cale + cÄƒutare â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ExerciÈ›ii Rezolvate

### ExerciÈ›iul 11.1: Calcul Dimensiune MaximÄƒ FiÈ™ier

ProblemÄƒ: CalculeazÄƒ dimensiunea maximÄƒ a unui fiÈ™ier Ã®n ext4 cu:

- Block size: 4KB
- Pointer size: 4 bytes
- 12 direct pointers, 1 single indirect, 1 double indirect, 1 triple indirect


SoluÈ›ie:

```
Pointeri per bloc = 4KB / 4B = 1024 pointeri

Direct:         12 Ã— 4KB = 48 KB

Single Indirect: 1024 Ã— 4KB = 4 MB

Double Indirect: 1024 Ã— 1024 Ã— 4KB = 4 GB

Triple Indirect: 1024 Ã— 1024 Ã— 1024 Ã— 4KB = 4 TB

Total maxim = 48KB + 4MB + 4GB + 4TB â‰ˆ 4TB

(Ãn practicÄƒ, ext4 foloseÈ™te extents pentru eficienÈ›Äƒ mai mare
È™i suportÄƒ fiÈ™iere pÃ¢nÄƒ la 16TB cu blocuri de 4KB)
```

---

## ÃntrebÄƒri Tip Examen

11.1 (GrilÄƒ) Un inode NU conÈ›ine:
- a) Permisiunile fiÈ™ierului
- b) Dimensiunea fiÈ™ierului
- c) Numele fiÈ™ierului âœ“
- d) Pointeri cÄƒtre blocuri de date

---

11.2 (5p) ExplicaÈ›i mecanismul de journaling È™i cele 3 moduri din ext4.

RÄƒspuns:

```
JOURNALING: TehnicÄƒ pentru integritatea sistemului de fiÈ™iere

Mecanism:
1. Ãnainte de modificare: Scrie intenÈ›ia Ã®n jurnal
2. EfectueazÄƒ modificarea
3. MarcheazÄƒ tranzacÈ›ia completÄƒ Ã®n jurnal
4. La crash: Recuperare din jurnal (replay sau discard)

MODURI ext4:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Mod      â”‚        Ce e journaled          â”‚ VitezÄƒ â”‚ SiguranÈ›Äƒâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   journal    â”‚ Metadate + Date (tot!)         â”‚  Lent  â”‚  MaximÄƒ  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ordered    â”‚ Metadate, dar datele se scriu  â”‚ Mediu  â”‚   BunÄƒ   â”‚
â”‚   (default)  â”‚ ÃNAINTE de commit              â”‚        â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   writeback  â”‚ Doar metadate (datele oricÃ¢nd) â”‚ Rapid  â”‚  MinimÄƒ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ordered: Compromis bun - datele noi sunt garantat pe disc Ã®nainte
ca metadatele sÄƒ pointeze la ele (evitÄƒ "garbage" Ã®n fiÈ™iere).
```

---

# SÄ‚PTÄ‚MÃ‚NA 13-14: Securitate È™i Virtualizare

## ExerciÈ›ii Rezolvate

### ExerciÈ›iul 13.1: Permisiuni Unix

ProblemÄƒ: Un fiÈ™ier are permisiunile `rwxr-x---`. 
a) Care e reprezentarea octalÄƒ?
b) Cine poate executa fiÈ™ierul?
c) Ce comandÄƒ seteazÄƒ aceste permisiuni?

SoluÈ›ie:

```
a) Reprezentare octalÄƒ:
   rwx = 4+2+1 = 7
   r-x = 4+0+1 = 5
   --- = 0+0+0 = 0
   
   RÄ‚SPUNS: 750

b) Cine poate executa:
   - Owner: DA (x Ã®n prima grupÄƒ)
   - Group: DA (x Ã®n a doua grupÄƒ)
   - Others: NU (--- nu are x)
   
   RÄ‚SPUNS: Owner È™i membrii grupului

c) ComandÄƒ:
   chmod 750 fisier
   sau
   chmod u=rwx,g=rx,o= fisier
```

---

### ExerciÈ›iul 14.1: Containere vs VM

ProblemÄƒ: ComparÄƒ timpul de pornire, overhead-ul de memorie È™i izolarea pentru VM vs Container pentru rularea unei aplicaÈ›ii web.

SoluÈ›ie:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Aspect        â”‚         VM           â”‚      Container       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Boot time          â”‚ 30-60 secunde        â”‚ 1-5 secunde          â”‚
â”‚                    â”‚ (Ã®ncarcÄƒ tot OS-ul)  â”‚ (doar procesul)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Memory overhead    â”‚ 500MB-2GB            â”‚ 10-100MB             â”‚
â”‚                    â”‚ (guest OS complet)   â”‚ (doar app + libs)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Disk footprint     â”‚ 5-50GB               â”‚ 100MB-1GB            â”‚
â”‚                    â”‚ (imagine OS)         â”‚ (layers de imagine)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Izolare            â”‚ COMPLETÄ‚             â”‚ PROCES                â”‚
â”‚                    â”‚ (hardware virtual)   â”‚ (kernel partajat)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Securitate         â”‚ Foarte bunÄƒ          â”‚ BunÄƒ (dar kernel     â”‚
â”‚                    â”‚ (escape dificil)     â”‚ exploits = risc)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Densitate          â”‚ ~10-20 VM/host       â”‚ ~100-1000 cont/host  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Use case           â”‚ Izolare strictÄƒ,     â”‚ Microservicii,       â”‚
â”‚                    â”‚ OS diferite          â”‚ CI/CD, scalare rapidÄƒâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ÃntrebÄƒri Tip Examen - Recapitulare

Final.1 (10p) Ãntrebare de sintezÄƒ: Descrie pas cu pas ce se Ã®ntÃ¢mplÄƒ cÃ¢nd tastezi `./program` Ã®n terminal, de la apÄƒsarea Enter pÃ¢nÄƒ cÃ¢nd procesul executÄƒ prima instrucÈ›iune.

RÄƒspuns model:

```
1. SHELL (proces pÄƒrinte):
   - CiteÈ™te comanda de la stdin
   - ParseazÄƒ: "./program" cu argumente
   
2. FORK:

Trei lucruri conteazÄƒ aici: shell apeleazÄƒ fork(), kernel creeazÄƒ proces copil:, È™i copil primeÈ™te 0, pÄƒrinte primeÈ™te pid copil.


3. EXEC (Ã®n copil):
   - Copilul apeleazÄƒ execve("./program", argv, envp)
   - Kernel:
     â€¢ Deschide fiÈ™ierul "./program"
     â€¢ CiteÈ™te header ELF (format executabil)
     â€¢ VerificÄƒ permisiunile (x)
     â€¢ ElibereazÄƒ vechiul spaÈ›iu de adrese
     â€¢ CreeazÄƒ nou spaÈ›iu de adrese:
       - TEXT: MapeazÄƒ codul din fiÈ™ier
       - DATA: IniÈ›ializeazÄƒ variabile globale
       - BSS: Zero-iniÈ›ializat
       - STACK: Alocat, pune argv/envp
       - HEAP: PregÄƒtit pentru malloc
     â€¢ SeteazÄƒ PC (program counter) la entry point

4. SCHEDULING:
   - Noul proces e pus Ã®n READY queue
   - Scheduler-ul (CFS Ã®n Linux) Ã®l selecteazÄƒ eventual
   - Context switch:
     â€¢ SalveazÄƒ starea procesului curent
     â€¢ ÃncarcÄƒ starea noului proces (registre, PC)

5. EXECUÈšIE:
   - CPU Ã®n user mode
   - Fetch prima instrucÈ›iune de la entry point
   - MMU traduce adresa virtualÄƒ (cu ajutorul TLB/page table)
   - InstrucÈ›iunea se executÄƒ
   
6. RUNTIME:
   - _start() din libc ruleazÄƒ
   - IniÈ›ializeazÄƒ runtime C
   - ApeleazÄƒ main() din program
   - Programul Ã®ncepe execuÈ›ia efectivÄƒ
```

---

## Formule È™i calcule esenÈ›iale pentru examen

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         IMPORTANT FORMULAE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SCHEDULING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Turnaround Time = Completion Time - Arrival Time
Waiting Time = Turnaround Time - Burst Time
Response Time = First Run Time - Arrival Time

CPU Utilisation = (Busy Time / Total Time) Ã— 100%
Throughput = Number of Processes / Total Time

MEMORY:
â”€â”€â”€â”€â”€â”€â”€â”€
Number of pages = Virtual address / Page size
Offset bits = logâ‚‚(Page size)
Page number bits = Total address bits - Offset bits

Page Table Size = Number of pages Ã— Entry size

TLB:
â”€â”€â”€â”€
EAT = Î± Ã— (Îµ + m) + (1-Î±) Ã— (Îµ + kÃ—m)

where:
  Î± = TLB hit rate
  Îµ = TLB access time
  m = memory access time
  k = page table levels + 1

PAGE REPLACEMENT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Page Fault Rate = Page Faults / Total References
Hit Rate = 1 - Page Fault Rate

BANKER'S ALGORITHM:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Need[i] = Max[i] - Allocation[i]
Available = Total - Î£(Allocation)

Safe state âŸº âˆƒ sequence in which all processes can finish
```

---

*Kit complet de exerciÈ›ii È™i Ã®ntrebÄƒri de examen â€” Sisteme de operare*

---

## ExerciÈ›ii avansate (Evaluare & Proiectare)

> ğŸ’¡ **AplicaÈ›ie practicÄƒ:** Aceste exerciÈ›ii reflectÄƒ decizii de proiectare reale luate de ingineri SO la companii precum Google, Microsoft È™i Amazon.

### E3.1: Analiza unui sistem de stocare (Evaluare) â­â­â­â­
**Dificultate:** Expert | **Timp:** ~15 min | **Nivel cognitiv:** Evaluare

Un serviciu de stocare cloud trebuie sÄƒ aleagÄƒ un sistem de fiÈ™iere pentru nodurile sale de stocare distribuitÄƒ. Fiecare nod are:
- 8 Ã— 4TB NVMe SSD-uri
- 256GB RAM
- CPU cu 64 de nuclee
- SarcinÄƒ de lucru: 80% citiri, 20% scrieri, dimensiune medie fiÈ™ier 64KB

**SarcinÄƒ:** EvaluaÈ›i aceste opÈ›iuni de sistem de fiÈ™iere È™i recomandaÈ›i cea mai bunÄƒ alegere:

| OpÈ›iune | Sistem de fiÈ™iere | Caracteristici cheie |
|---------|-------------------|---------------------|
| A | ext4 | Jurnalizare, matur, suport larg |
| B | XFS | PerformanÈ›Äƒ excelentÄƒ pentru fiÈ™iere mari, I/O paralel |
| C | Btrfs | Copy-on-write, snapshot-uri, checksum-uri |
| D | ZFS | Checksum-uri end-to-end, compresie, deduplicare |

LuaÈ›i Ã®n considerare:
1. PerformanÈ›a la citire pentru sarcina de lucru dominantÄƒ
2. Amplificarea scrierilor pe SSD-uri
3. GaranÈ›ii de integritate a datelor
4. Complexitate operaÈ›ionalÄƒ
5. Timp de recuperare dupÄƒ crash

**RÄƒspuns model:**
```
ANALIZÄ‚:

1. PerformanÈ›Äƒ la citire (80% din sarcinÄƒ):
   - ext4: BunÄƒ (simplu, overhead mic)
   - XFS: BunÄƒ (optimizat pentru citiri paralele)
   - Btrfs: ModeratÄƒ (overhead CoW pe cÄƒile de citire minimal)
   - ZFS: BunÄƒ (cache ARC excelent pentru citiri repetate)
   
   CÃ¢È™tigÄƒtor: XFS sau ZFS (ambele optimizate pentru I/O paralel)

2. Amplificarea scrierilor (criticÄƒ pentru longevitatea SSD):
   - ext4: MicÄƒ (actualizÄƒri in-place cu jurnalizare)
   - XFS: MicÄƒ (similar cu ext4)
   - Btrfs: MARE (CoW Ã®nseamnÄƒ cÄƒ fiecare scriere creeazÄƒ blocuri noi)
   - ZFS: MARE (arhitecturÄƒ CoW)
   
   CÃ¢È™tigÄƒtor: ext4 sau XFS
   
   NotÄƒ: Sistemele de fiÈ™iere CoW pot reduce durata de viaÈ›Äƒ a SSD-urilor
   cu 2-3Ã— din cauza amplificÄƒrii scrierilor. Cu 20% scrieri pe 32TB, conteazÄƒ.

3. Integritatea datelor:
   - ext4: De bazÄƒ (jurnalul protejeazÄƒ doar metadatele)
   - XFS: De bazÄƒ (similar cu ext4)
   - Btrfs: PuternicÄƒ (checksum-uri pe date È™i metadate)
   - ZFS: Cea mai puternicÄƒ (checksum-uri end-to-end, auto-vindecare cu mirror-uri)
   
   CÃ¢È™tigÄƒtor: ZFS > Btrfs > ext4 â‰ˆ XFS

4. Complexitate operaÈ›ionalÄƒ:
   - ext4: Cea mai micÄƒ (Linux standard, toate uneltele funcÈ›ioneazÄƒ)
   - XFS: MicÄƒ (bine documentat, dovedit enterprise)
   - Btrfs: Medie (mai puÈ›in matur, unele caracteristici instabile)
   - ZFS: Medie-Mare (lanÈ› de unelte separat, probleme de licenÈ›iere)
   
   CÃ¢È™tigÄƒtor: ext4 > XFS > ZFS > Btrfs

5. Recuperare dupÄƒ crash:
   - ext4: RapidÄƒ (replay jurnal)
   - XFS: RapidÄƒ (replay jurnal paralel)
   - Btrfs: LentÄƒ (reconstrucÈ›ie arbore)
   - ZFS: Medie (replay grup de tranzacÈ›ii)
   
   CÃ¢È™tigÄƒtor: XFS > ext4 > ZFS > Btrfs

RECOMANDARE: XFS

RaÈ›iune:
- Cel mai bun echilibru Ã®ntre performanÈ›a la citire È™i longevitatea SSD-urilor
- Dovedit la scarÄƒ (folosit de Red Hat, mulÈ›i furnizori cloud)
- Recuperare rapidÄƒ (criticÄƒ pentru disponibilitate ridicatÄƒ)
- Pentru integritatea datelor, implementaÈ›i checksum-uri la nivel de aplicaÈ›ie
  (mai ieftin decÃ¢t overhead-ul ZFS, mai flexibil)

AlternativÄƒ: DacÄƒ integritatea datelor este primordialÄƒ È™i amplificarea
scrierilor este acceptabilÄƒ (ex. stocare arhivÄƒ), ZFS ar fi preferat.
```

---

### E3.2: ArhitecturÄƒ de virtualizare (Proiectare) â­â­â­â­
**Dificultate:** Expert | **Timp:** ~20 min | **Nivel cognitiv:** Proiectare

**Scenariu:** ProiectaÈ›i o soluÈ›ie de virtualizare uÈ™oarÄƒ pentru un laborator universitar de predare care trebuie sÄƒ:

| CerinÈ›Äƒ | SpecificaÈ›ie |
|---------|--------------|
| SO gazdÄƒ | Ubuntu 24.04 LTS |
| InstanÈ›e guest | 30 concurente (una per student) |
| SO guest | Ubuntu 24.04 minimal |
| Resurse per guest | 2 vCPU, 2GB RAM, 10GB stocare |
| Hardware gazdÄƒ | 64 nuclee, 256GB RAM, 2TB NVMe |
| ÈšintÄƒ timp boot | < 10 secunde per guest |
| Nivel izolare | La nivel de proces acceptabil (uz educaÈ›ional) |

**SarcinÄƒ:** ProiectaÈ›i arhitectura de virtualizare:

a) AlegeÈ›i Ã®ntre VM-uri complete, containere sau hibrid â€” justificaÈ›i
b) SpecificaÈ›i stiva tehnologicÄƒ (hypervisor/runtime, orchestrare, reÈ›ea)
c) CalculaÈ›i alocarea resurselor È™i ratele de supraalocare
d) ProiectaÈ›i topologia de reÈ›ea pentru accesul la internet al guest-urilor
e) PropuneÈ›i un mecanism de snapshot/resetare pentru sesiunile de laborator

**RÄƒspuns model:**
```
a) Alegere arhitecturÄƒ: CONTAINERE (cu izolare Ã®mbunÄƒtÄƒÈ›itÄƒ)

   Justificare:
   - Timp boot: Containere < 2s vs VM-uri > 30s
   - EficienÈ›Äƒ memorie: Kernel partajat economiseÈ™te ~1GB per instanÈ›Äƒ
   - EficienÈ›Äƒ stocare: Imagini stratificate, doar delta-urile stocate
   - Izolarea la nivel de proces suficientÄƒ pentru utilizatori educaÈ›ionali (de Ã®ncredere)
   
   NU VM-uri complete deoarece:
   - 30 Ã— 2GB = 60GB RAM doar pentru guest-uri (Ã®nainte de overhead SO)
   - VM-urile ar avea nevoie de 30 Ã— 10GB = 300GB stocare minim
   - Timpul de boot ar depÄƒÈ™i È›inta de 10s
   
   Izolare Ã®mbunÄƒtÄƒÈ›itÄƒ prin: gVisor sau Kata Containers dacÄƒ este nevoie
   de izolare mai puternicÄƒ (abordare hibridÄƒ).

b) Stiva tehnologicÄƒ:

   Container Runtime: Docker cu containerd
   - Matur, bine documentat, studenÈ›ii sunt deja familiari
   
   Orchestrare: Docker Compose + scripturi personalizate
   - Kubernetes prea complex pentru laborator single-host
   - Scripturi bash simple pentru start/stop/reset
   
   Imagine: Ubuntu 24.04 minimal personalizat (~500MB)
   - Pre-instalate: gcc, python3, vim, git
   - Strat de bazÄƒ read-only
   
   Storage Driver: overlay2
   - Cea mai bunÄƒ performanÈ›Äƒ pe ext4/xfs
   - Partajare eficientÄƒ a straturilor

c) Calculul resurselor:

   CPU:
   - GazdÄƒ: 64 nuclee
   - Guest-uri: 30 Ã— 2 vCPU = 60 vCPU solicitate
   - Rata de supraalocare: 60/64 = 0.94Ã— (acceptabil, CPU-ul e time-shared)
   
   Memorie:
   - GazdÄƒ: 256GB, rezervÄƒ 16GB pentru SO gazdÄƒ
   - Disponibil: 240GB
   - Guest-uri: 30 Ã— 2GB = 60GB
   - Rata de supraalocare: 60/240 = 0.25Ã— (foarte conservator, bine)
   - Poate face burst la 4GB per guest dacÄƒ e nevoie
   
   Stocare:
   - Imagine de bazÄƒ: 500MB (partajatÄƒ prin overlay2)
   - Strat inscriptibil per student: ~2GB Ã®n medie
   - Total: 500MB + (30 Ã— 2GB) = 60.5GB
   - Gazda are 2TB â†’ mult spaÈ›iu disponibil

d) Topologie de reÈ›ea:

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ GAZDÄ‚: Ubuntu 24.04                                 â”‚
   â”‚                                                     â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   â”‚  â”‚ Docker Bridge: lab-network (172.20.0.0/16)  â”‚   â”‚
   â”‚  â”‚                                             â”‚   â”‚
   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â” â”‚   â”‚
   â”‚  â”‚  â”‚ S01  â”‚ â”‚ S02  â”‚ â”‚ S03  â”‚ ...  â”‚ S30  â”‚ â”‚   â”‚
   â”‚  â”‚  â”‚.0.10 â”‚ â”‚.0.11 â”‚ â”‚.0.12 â”‚      â”‚.0.39 â”‚ â”‚   â”‚
   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   â”‚                        â”‚                          â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚  â”‚ iptables NAT: MASQUERADE cÄƒtre eth0          â”‚ â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
   â”‚                        â”‚                          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                   [ReÈ›eaua UniversitÄƒÈ›ii]
   
   Caracteristici:
   - Fiecare student primeÈ™te IP predictibil: 172.20.0.(10+N)
   - NAT pentru acces internet outbound
   - OpÈ›ional: Port forwarding pentru acces SSH din exterior

e) Mecanism Snapshot/Resetare:

   #!/bin/bash
   # reset_lab.sh - ReseteazÄƒ toate containerele studenÈ›ilor
   
   BASE_IMAGE="ase-os-lab:2024"
   
   for i in $(seq 1 30); do
       STUDENT="student$(printf '%02d' $i)"
       
       # OpreÈ™te È™i È™terge containerul existent
       docker stop $STUDENT 2>/dev/null
       docker rm $STUDENT 2>/dev/null
       
       # CreeazÄƒ container nou din imaginea de bazÄƒ
       docker create \
           --name $STUDENT \
           --hostname $STUDENT \
           --memory 2g \
           --cpus 2 \
           --network lab-network \
           --ip 172.20.0.$((10 + i)) \
           $BASE_IMAGE
       
       docker start $STUDENT
   done
   
   Flux de lucru:
   - Ãnceput laborator: ruleazÄƒ reset_lab.sh (30 containere noi Ã®n ~60s)
   - Ãn timpul laboratorului: studenÈ›ii lucreazÄƒ liber
   - SfÃ¢rÈ™it laborator: opÈ›ional exportÄƒ munca studenÈ›ilor, apoi reseteazÄƒ
   - Imaginea de bazÄƒ actualizatÄƒ semestrial cu unelte noi
```

---

*Materiale dezvoltate de Revolvix pentru ASE BucureÈ™ti â€” CSIE*
*Anul I, Semestrul 2 | 2025â€“2026*
