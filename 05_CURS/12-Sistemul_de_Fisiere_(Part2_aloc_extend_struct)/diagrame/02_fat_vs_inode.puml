@startuml
!theme plain
skinparam backgroundColor #FEFEFE
skinparam defaultFontName DejaVu Sans
skinparam defaultFontSize 10

title Comparație: Alocare FAT vs inode (ext4)
caption Curs 12: Sistemul de Fișiere Part 2 — Metode de Alocare

left to right direction

package "**FAT (File Allocation Table)**" as FAT_PKG #LightBlue {
  rectangle "Directory Entry" as DE_FAT #White {
    rectangle "filename.txt\nstart: 5\nsize: 10KB" as entry_fat
  }
  
  rectangle "FAT Table\n(în memorie)" as FAT_TABLE #LightYellow {
    rectangle "[5]→7\n[6]→EOF\n[7]→9\n[8]→free\n[9]→6" as fat_entries
  }
  
  rectangle "Data Blocks" as DATA_FAT #LightGreen {
    rectangle "5 | 7 | 9 | 6" as blocks_fat
  }
  
  entry_fat -down-> FAT_TABLE : "index\nprim bloc"
  FAT_TABLE -down-> DATA_FAT : "lanț:\n5→7→9→6→EOF"
}

package "**inode (ext4)**" as INODE_PKG #LightCoral {
  rectangle "Directory Entry" as DE_INODE #White {
    rectangle "filename.txt\ninode: 42" as entry_inode
  }
  
  rectangle "inode #42" as INODE #LightYellow {
    rectangle "size: 10KB\nmode: 0644\ndirect[0]: 100\ndirect[1]: 105\n..." as inode_data
  }
  
  rectangle "Data Blocks" as DATA_INODE #LightGreen {
    rectangle "100 | 105 | ..." as blocks_inode
  }
  
  entry_inode -down-> INODE : "lookup\ninode #"
  INODE -down-> DATA_INODE : "pointeri\ndirecți"
}

note bottom of FAT_PKG
  **Avantaje FAT:**
  ✓ Simplitate
  ✓ Compatibilitate universală (USB, SD)
  ✓ Ușor de reparat
  
  **Dezavantaje FAT:**
  ✗ FAT-ul trebuie în RAM (overhead)
  ✗ Acces secvențial pentru găsire bloc
  ✗ Fragmentare severă
  ✗ Fără permisiuni/owner
  ✗ Limită 4GB/fișier (FAT32)
end note

note bottom of INODE_PKG
  **Avantaje inode:**
  ✓ Acces rapid O(1) via pointeri direcți
  ✓ Metadata per fișier (permisiuni, timestamps)
  ✓ Hard links native
  ✓ Extents pentru fișiere mari (ext4)
  ✓ Journal pentru consistență
  
  **Dezavantaje:**
  ✗ Complexitate implementare
  ✗ Limită număr inode-uri (fixat la format)
  ✗ Overhead pentru fișiere foarte mici
end note

@enduml
