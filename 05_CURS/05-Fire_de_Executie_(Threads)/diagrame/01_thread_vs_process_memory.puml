@startuml thread_vs_process_memory
!include ../../diagrame_common/skin.puml
title Thread vs Process - Layout Memorie

skinparam rectangle {
    roundCorner 5
}

rectangle "**PROCESE SEPARATE**" as procs #FAFAFA {
    rectangle "Proces A (PID 1000)" as procA #E3F2FD {
        rectangle "Stack A" as stackA #FFCDD2
        rectangle "Heap A" as heapA #FFF9C4
        rectangle "Data A" as dataA #C8E6C9
        rectangle "Text A" as textA #BBDEFB
    }
    
    rectangle "Proces B (PID 2000)" as procB #FCE4EC {
        rectangle "Stack B" as stackB #FFCDD2
        rectangle "Heap B" as heapB #FFF9C4
        rectangle "Data B" as dataB #C8E6C9
        rectangle "Text B" as textB #BBDEFB
    }
    
    note bottom of procs
    **Izolare COMPLETĂ**
    A nu poate accesa memoria lui B
    Comunicare: IPC (pipes, sockets)
    end note
}

rectangle "**UN PROCES CU THREADS**" as threads #FAFAFA {
    rectangle "Proces P (PID 1000) - 3 Threads" as procP #E8F5E9 {
        
        rectangle "**SEPARATE per Thread**" as separate #FFCDD2 {
            rectangle "Stack T1\nRegistre T1\nPC T1" as t1 #FFFFFF
            rectangle "Stack T2\nRegistre T2\nPC T2" as t2 #FFFFFF
            rectangle "Stack T3\nRegistre T3\nPC T3" as t3 #FFFFFF
        }
        
        rectangle "**PARTAJATE**" as shared #C8E6C9 {
            rectangle "Heap\n(shared_counter, mutex)" as heap #FFFFFF
            rectangle "Data/BSS\n(variabile globale)" as data #FFFFFF
            rectangle "Text (Code)" as text #FFFFFF
            rectangle "File Descriptors" as fd #FFFFFF
        }
    }
    
    note bottom of threads
    **Izolare MINIMĂ**
    Toate thread-urile văd aceleași date
    ⚠️ **Nevoie de sincronizare!**
    end note
}

procs -[hidden]right-> threads

legend bottom
|= Aspect |= Procese |= Threads |
| Address Space | SEPARAT | PARTAJAT |
| Stack | SEPARAT | SEPARAT |
| Heap | SEPARAT | **PARTAJAT** |
| Creare | ~1-10 ms | ~10-100 μs |
| Comunicare | IPC | Direct (memorie) |
| Crash | Doar procesul | Tot procesul |
endlegend

@enduml
