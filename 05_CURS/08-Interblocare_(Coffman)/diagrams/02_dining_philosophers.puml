
@startuml dining_philosophers
!include ../../diagrams_common/skin.puml
title Dining Philosophers Problem - Deadlock

skinparam rectangle {
    roundCorner 50
}

' Round table
circle "**TABLE**" as table #FFF9C4

' Philosophers
rectangle "**P0**\nðŸ¤”" as p0 #E3F2FD
rectangle "**P1**\nðŸ¤”" as p1 #E3F2FD
rectangle "**P2**\nðŸ¤”" as p2 #E3F2FD
rectangle "**P3**\nðŸ¤”" as p3 #E3F2FD
rectangle "**P4**\nðŸ¤”" as p4 #E3F2FD

' Forks
rectangle "F0\nðŸ´" as f0 #C8E6C9
rectangle "F1\nðŸ´" as f1 #C8E6C9
rectangle "F2\nðŸ´" as f2 #C8E6C9
rectangle "F3\nðŸ´" as f3 #C8E6C9
rectangle "F4\nðŸ´" as f4 #C8E6C9

' Circular arrangement
p0 -[hidden]down- table
p1 -[hidden]down- table
p2 -[hidden]down- table
p3 -[hidden]down- table
p4 -[hidden]down- table

' Holds (solid) - each has picked up left fork
p0 -[#27AE60,bold]-> f0 : holds
p1 -[#27AE60,bold]-> f1 : holds
p2 -[#27AE60,bold]-> f2 : holds
p3 -[#27AE60,bold]-> f3 : holds
p4 -[#27AE60,bold]-> f4 : holds

' Waits (dashed) - each wants right fork
p0 -[#E74C3C,dashed]-> f1 : waits
p1 -[#E74C3C,dashed]-> f2 : waits
p2 -[#E74C3C,dashed]-> f3 : waits
p3 -[#E74C3C,dashed]-> f4 : waits
p4 -[#E74C3C,dashed]-> f0 : waits

note bottom
**DEADLOCK!**
Cycle: P0â†’F1â†’P1â†’F2â†’P2â†’F3â†’P3â†’F4â†’P4â†’F0â†’P0

**Solutions:**
1. Asymmetric: P4 picks up right fork first
2. Limit: Max 4 philosophers at table
3. All-or-nothing: Pick up both or none
4. Arbiter: A waiter coordinates
end note

legend right
|= Line |= Meaning |
|<#27AE60> solid| Holds resource |
|<#E74C3C> dashed| Waits for resource |
endlegend

@enduml
